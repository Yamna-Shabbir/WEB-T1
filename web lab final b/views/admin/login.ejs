<%- include('layout', {
  title: 'Admin Login - Gym Supplies Hub',
  page: 'login',
  pageTitle: 'Admin Login',
  body: `
    <div class="admin-card" style="max-width: 400px; margin: 50px auto;">
      <div class="admin-card-header">
        <h3><i class="fa-solid fa-shield-halved"></i> Admin Login</h3>
      </div>
      
      <div id="alertContainer"></div>
      
      <form id="loginForm" class="admin-form">
        <div class="form-group-admin">
          <label for="email">Email *</label>
          <input type="email" id="email" name="email" class="form-control" required placeholder="admin@example.com">
        </div>
        
        <div class="form-group-admin">
          <label for="password">Password *</label>
          <input type="password" id="password" name="password" class="form-control" required placeholder="Enter your password">
        </div>
        
        <div class="form-actions-admin">
          <button type="submit" class="btn-admin btn-primary-admin" style="width: 100%;">
            <i class="fa-solid fa-sign-in-alt"></i> Login
          </button>
        </div>
      </form>
      
      <div class="text-center mt-3">
        <p class="text-muted">Don't have an account? <a href="/admin/signup" style="color: #3b82f6;">Sign up</a></p>
      </div>
    </div>
  `,
  scripts: `
    <script>
      document.getElementById('loginForm').addEventListener('submit', async function(e) {
        e.preventDefault();
        
        const submitButton = e.target.querySelector('button[type="submit"]');
        const originalText = submitButton.innerHTML;
        submitButton.disabled = true;
        submitButton.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> Logging in...';
        
        const formData = new FormData(e.target);
        const loginData = {
          email: formData.get('email'),
          password: formData.get('password')
        };
        
        try {
          const response = await fetch('/api/auth/admin/login', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify(loginData)
          });
          
          const data = await response.json();
          
          if (data.success) {
            showAlert('Login successful! Redirecting...', 'success');
            setTimeout(() => {
              window.location.href = '/admin';
            }, 1000);
          } else {
            showAlert(data.message || 'Login failed', 'error');
            submitButton.disabled = false;
            submitButton.innerHTML = originalText;
          }
        } catch (error) {
          console.error('Login error:', error);
          showAlert('Error logging in. Please try again.', 'error');
          submitButton.disabled = false;
          submitButton.innerHTML = originalText;
        }
      });
      
      function showAlert(message, type) {
        const container = document.getElementById('alertContainer');
        const alertClass = type === 'success' ? 'alert-success' : 'alert-error';
        container.innerHTML = '<div class="alert-admin ' + alertClass + '"><i class="fa-solid fa-' + (type === 'success' ? 'check-circle' : 'exclamation-circle') + '"></i> ' + message + '</div>';
        
        setTimeout(() => {
          container.innerHTML = '';
        }, 5000);
      }
    </script>
  `
}) %>


